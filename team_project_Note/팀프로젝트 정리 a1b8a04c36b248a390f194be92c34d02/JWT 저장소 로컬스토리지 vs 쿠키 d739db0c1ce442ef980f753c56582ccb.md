# JWT 저장소 로컬스토리지 vs 쿠키

[참고자료](https://www.linkedin.com/pulse/best-place-your-jwts-comparing-local-storage-cookies-atkinson-lerue)

서버로 부터 받은 JWT 토큰을 클라이언트 측에서 저장하는 곳은 여러곳이 있을수 있는데 대표적으로 사용되는 로컬 스토리지와 쿠키에 대한 비교

### 로컬 스토리지 장점

- 간단하게 로컬스토리지에 저장할 수 있습니다.
- javascript를 사용하여 토큰을 쉽게 설정하고, 관리 할 수 있습니다.
- 브라우저가 닫힌 후에도 데이터를 유지하므로 사용자의 인증 상태가 세션 전반에 걸쳐 보존됩니다. (세션 스토리지는 유지x)

### 로컬 스토리지 단점

- XSS(교차 사이트 스크립팅) 공격에 대한 취약합니다.
    - XSS 이란 ?
        
        공격자가 합법적인 웹 사이트에 코드를 첨부하여 피해자가 웹 사이트를 로드 할 때 이 코드가 실행되도록 하는 익스플로잇입니다. 
        
        - 익스플로잇 : 해커의 의도대로 공격하도록 설계된 명령, 스크립트, 또는 프로그램을 의미합니다.
- 보안 플래그를 지정하는 옵션을 제공하지 않아서 보안에 취약할 수 있습니다.

### 쿠키 저장소 장점

- HttpOnly 플래그를 설정하면 javascript가 쿠키에 액세스하지 못하게 하여 XSS 공격을 완화시킬 수 있습니다.
- Secure 플래그 또한 쿠키가 HTTPS 통해서만 전송되도록 보장하고 SameSite 속성을 설정하여 교차 사이트를 제한 시켜 CSRF 공격으로부터 보호 할 수 있습니다.

### 쿠키 저장소 단점

- 저장할 수 있는 크기에 제한이 있어서 JWT가 크거나, 여러 다른 쿠키가 사용되는 제약이 있을 수 있다.
- 클라이언트 측에서 쿠키를 관리한다는 것은 여러가지 쿠키를 구별하고 만료를 처리해줘야 하므로 훨씬 복잡한 처리가 필요합니다.

---

### 대체 저장소

### 세션 스토리지

- 지정된 각 원본에 대해 별도의 저장소 영역을 유지하지만 페이지 세션 기간 동안에만 유지됩니다.
- 브라우저 탭을 닫는 등 세션이 종료되면 자동으로 저장된 데이터들이 지워집니다.
- JWT토큰이 단일세션에 대해서만 필요하고 그 이후에 관리가 필요없는 상황에서 이상적인 선택입니다.

### 인메모리 스토리지

- 애플리케이션 수명 기간 동안 JavaScript 변수 내에 토큰을 유지하는 작업이 포함됩니다.
- 토큰이 애플리케이션의 메모리 내에 완전히 남아 있고 브라우져의 저장소 메커니즘에 노출되지 않아서 보안적으로 안전합니다.
- 사용자가 페이지를 새로 고치거나 브라우저 탭을 닫으면 저장된 토큰이 손실되어서 역시 재인증 프로세스를 거쳐야 한다.